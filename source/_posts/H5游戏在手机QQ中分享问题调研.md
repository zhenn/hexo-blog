title: "H5游戏在手机QQ中分享问题调研"
date: 2015-06-29 19:34:41
categories: 技术
tags: 手机QQ分享
---

![](/img/g/11.png)

#### 问题描述
____

- 用户A在碰碰客户端内，分享“你懂我吗”到QQ好友B
- B进入QQ，打开对话框分享气泡进入游戏
- B顺利完成游戏后，创建自己的问卷，然后分享游戏给自己的QQ好友C
- 好友C打开游戏页面，显示问卷创建者是碰碰用户A
- 正常情况下，应该显示创建者为QQ用户B

**补充：**用户B，仅通过“分享给QQ好友”渠道出出现问题，其他诸如“分享到QQ空间”、“分享给微信好友”、“分享到朋友圈”均正常。

<!--more-->

#### 分析调研
____

按以上操作路径，B必须使用IOS设备使用QQ打开游戏，方可复现问题，若B使用Android，则无法复现。另外，复现条件不仅包括碰碰客户端，即使用户A从微信分享游戏到QQ好友，亦会出现同样问题。

初步结论，问题出现和从哪儿分享到QQ无关。

结合业务分析，由C用户看到的游戏创建者是A，可以推断C打开的链接地址为碰碰用户A从其他客户端分享出的链接，而非B在游戏分享时的链接。

经过在QQ好友对话框手动输入游戏地址，创建游戏、分享游戏，整个流程符合预期，完全不存在问题。

#### demo验证
____

在微信中使用webview打开测试页面:（简称URL1），将看到如下展示：

![](/img/g/1.png)]

在页面中点击跳转按钮，页面地址就跳转到: (简称URL2)，跳转按钮显示，并显示“已经跳转到主人态”。

此时先不必执行跳转操作，先点击右上角’...’分享页面给QQ好友，留在QQ，点击如下分享气泡。

![](/img/g/2.png)

将进入页面URL1，展示如下。

![](/img/g/3.png)

点击跳转按钮，页面将跳转到URL2。

![](/img/g/4.png)

注意：以下才是问题的关键。

点击右上角红色标注按钮，继续分享给QQ好友，此时的分享信息中的页面地址为URL1，而不是URL2。当然，这仅仅发生在IOS QQ客户端中，在Android中则完全符合我们的预期。

而且，即使在IOS QQ客户端内，通过扫二维码、对话框点击链接直接进入URL1，不从好友的分享气泡进入，再执行后续操作，也不会出现问题。

#### 结论
____

在IOS QQ客户端，由分享气泡进入页面，后续业务流程中出现链接跳转，执行“分享给QQ好友”，分享的链接的地址为跳转前地址，Android QQ客户端不存在此问题。